マルウェア動作検証およびシグネチャ作成
=============

環境構築手順
-------

### 手順1

PCを３台（もしくは４台）とIPSと有線ケーブルを３本（もしくは４本)用意する。

TODO: 有線ケーブルがどのようなときに3本になってどのようなときに4本になるか記述いただけますでしょうか？

### 手順2

PCの役割を決める。今回は以下のとおりに設定した。

TODO: アカウント名やパスワードについては使う機器によって違うので，ここに直接書かないでOKです．削除しておいてもらえればと思います．

- ① アナリストチーム検証用(PW:abc123)：ルーター用
- ② アナリストチーム検証機 #1(PW:abc123)：VM上でマルウェアを感染させる用のPC
- ③ Monitoring機器(PW:soc123!)；Security Alertログを見たり、User Definedを作成したりするためのPC
- ④ ID:Honey Potter PW:abc123：実機でマルウェアを感染させる用のPC)

### 手順3

IPSに有線ケーブルを繋ぐ。以下を参照にして繋いでください。

- ①→"PROTECTED"
- ②→"PROTECTED"
- ③→"MANAGEMENT"

### 手順4

IPSとPCを起動させる。

### 手順5

①のPCを設定する。
	1.モバイルルーターを接続させる。
	2.ネットワークの設定をする。

TODO: ネットワークの設定は具体的にどうするのかわかりますか？

### 手順6

②のPCを設定する。

1. VM上と共有するためのフォルダーとローカルに保存するためのフォルダーを作成する。
2. VM VirtualBoxを起動して共有できるよう設定する。以下設定方法。
		自分が起動したいものをクリック→[設定]をクリック→[共有フォルダー]をクリック→フォルダーリスト内の共有フォルダを右クリック
		→[共有フォルダーを追加]→パス名を入力し自動マウントにチェック→出来上がり
3. マルウェアに感染しても綺麗な状態にすぐ戻せるようスナップ写真を作成しておく。以下作成方法。
		[最新の状態]を選択→カメラアイコンをクリック→出来上がり
4. 起動してtestアカウント(PW:abc123)でログインして検証を始める。
	
### 手順7

③のPCを設定する。
	1.https://192.168.50.100に接続する。(今回はFirefoxで)
	2.ID:admin PW:abc123で認証する。
	3.接続する、ブロックしないと選択していけばモニタリングできる。

検証手順
-------

TODO: あらかじめマルウェアの検体そのもの，もしくはハッシュ値を用意しておく必要があることを追記いただけますか？

### 手順1

VirusTotal(https://www.virustotal.com/ja/)にログインして、欲しいマルウェアをダウンロードする。

※今回は水谷さんのアカウントを拝借させていただきました。ちなみにこの中でログインできるのIBM社員のみ。

### 手順2

TODO: 共有フォルダーとローカルに保有するためのフォルダというのは，それぞれどのディレクトリなのか？ 何の目的なのかということを追記いただけますか？

ダウンロードしたファイル共有フォルダーとローカルに保存するためのフォルダーにコピーする。

### 手順3

TODO: 事前にクリーンな状態のスナップショットが作成されていることを確認し，そのスナップショットを起動する，のような記述を追記いただけますか？

VM VirtualBoxのスナップショットを起動する。

### 手順4

TODO: ここでのデスクトップはVM上のデスクトップということでよいでしょうか？

共有フォルダーを開きマルウェアのファイルをデスクトップに移す。

### 手順5

デスクトップに置いたマルウェアのファイル名を変更する。
	※名前は何でもいいが拡張子は必ず「.exe」にする。
	
### 手順6

TODO: キャプチャを開始するという旨を追記いただけますか？

Wiresharkを起動してちゃんと動いているかを確認してからマルウェアを動かす。

### 手順7

TODO: どういうタイミングでWiresharkを止めるのかの判断基準を追記いただけますか？

Wiresharkのログデータを共有フォルダーに保存しローカルで見ることができるか確認する。

### 手順8

確認できたらVM上のWindowsをシャットダウンして、スナップショットを復元する。

※必ず「現在のマシンの状態のスナップショットを作成」のチェックボックスからチェックをはずす。

連続して検証する際はこれを繰り返す。


記録方法
---------

- `report/(ハッシュ値).md` のファイルを作成し検証に関するまとめを記述してください
- `report/(ハッシュ値).pcap` のファイル名で通信データの記録を保存してください

例)

- `report/15c926d2602f65be0de65fa9c06aa6c6.md`
- `pcap/15c926d2602f65be0de65fa9c06aa6c6.pcap`
